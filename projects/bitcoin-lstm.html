<!doctype html>
<html lang="en">
    <head>
        

        <meta charset="utf-8">
        <title></title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="../css/stack-interface.css" rel="stylesheet" type="text/css" media="all">
        <link href="../css/socicon.css" rel="stylesheet" type="text/css" media="all" />
        <link href="../css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
        <link href="../css/flickity.css" rel="stylesheet" type="text/css" media="all" />
        <link href="../css/stack-interface.css" rel="stylesheet" type="text/css" media="all" />
        <link href="../css/theme-serpent.css" rel="stylesheet" type="text/css" media="all" />
        <link href="../css/custom.css" rel="stylesheet" type="text/css" media="all" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:200,300,400,400i,500,600,700" rel="stylesheet">

    </head>
    <section class="bg--primary">
    <section>
    <body data-smooth-scroll-offset="77">
        <div class="nav-container">
            <div class="via-1593100097550" via="via-1593100097550" vio="About me">
                <div class="bar bar--xs visible-xs ">
                    <div class="container">
                        <div class="row">
                            <div class="col-3 col-md-2">
                                <a href="../index.html"> <img class="logo logo-dark" alt="logo" src="../cap.png"> <img class="logo logo-light" alt="logo" src="../cap.png"> </a>
                            </div>
                            <div class="col-9 col-md-10 text-right">
                                <a href="#" class="hamburger-toggle" data-toggle-class="#menu1;hidden-xs hidden-sm"> <i class="icon stack-interface stack-menu"></i> </a>
                            </div>
                        </div>
                    </div>
                </div>
                <nav id="menu1" class="bar bar-1 hidden-xs ">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-1 col-md-2 hidden-xs">
                                <div class="bar__module">
                                    <a href="../index.html"> <img class="logo logo-dark" alt="logo" src="../cap.png"> <img class="logo logo-light" alt="logo" src="../cap.png"> </a>
                                </div>
                            </div>
                            <div class="col-lg-11 col-md-12 text-right text-left-xs text-left-sm">
                                <div class="bar__module">
                                    <ul class="menu-horizontal text-left">
                                        <li> <a href="../index.html">
                                        HOME</a> </li>
                                        <li> <a href="../projects.html">PROJECTS</a> </li>
                                        <li> <a href="../about-me.html">
                                        ABOUT ME</a> </li>
                                        <li> <a href="../contact-me.html">
                                        CONTACTS</a> </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
        </section>
        <div class="main-container">
            <section class="unpad--bottom switchable cta cta-3" style="padding-top:3em; padding-bottom:3em">
                <div class="container">
                    <div class="row">
                        <div class="card card-1 boxed boxed--sm boxed--border hidden-sm hidden-md hidden-lg" style="padding-bottom:2em; margin-left:1em;">
                            <div> <img alt="Image" class="block" src="../images/project images/bitcoin/bitcoin.jpg"> </div> 
                        </div>
                        <div class="col-md-6 col-lg-7">
                            <div class="switchable__text" style="margin-top:1em">
                                <h2><b>Predicting Bitcoin price using Neural Networks</b></h2>
                                <p class="lead">Machine learning has been one of the hottest topics over these years. It has found applications in many interesting fields, such as analyzing and predicting time series data, even in financial markets. In this project, we try to use a special kind of Recurrent Neural Network, called LSTM, to try to predict Bitcoin price data. </p>
                                <a class="btn type--uppercase btn--primary" href="https://github.com/federicodeservi/bitcoin-lstm-prediction"> <span class="btn__text">
                            View Code<br></span> </a>
                            </div>
                        </div>
                        <div class="card card-1 boxed boxed--sm boxed--border hidden-xs" style="width:60%; margin-right:2em">
                            <div> <img alt="Image" class="block" src="../images/project images/bitcoin/bitcoin.jpg"> </div> 
                        </div>
                    </div>
                </div>
            </section>
            </section>
            <section class="unpad">
                <article>
                    <div>
                        <div class="container">
                            <div class="row justify-content-center">
                                <div class="col-md-10 col-lg-8" style="padding-top:3em">
                                    <div class="article__body">
                                        
                                        <p class="citation">This is a classic stock market prediction problem, and as such, we need to make clear that predicting price behavior is a really difficult problem, as we will see later in this project.<br></p>
                                        
                                        
                                        <p class="lead">All code used is available in this <a href="https://github.com/federicodeservi/bitcoin-lstm-prediction">Github repository</a></p>
                                        <p class="lead"><strong>NB!</strong> This content is for informational and research purposes only. It is not intended to be legal, tax, investment, financial, or other advice.</p>
                                        <h2 id="summary"><b>Summary</b></h2>
                                        <p class="lead">First, I will briefly introduce <strong>Recurrent Neural Networks</strong> and LSTM. Then I will present the <strong>first model</strong> built for this project, a univariate LSTM that uses past bitcoin price data to make new predictions. The <strong>second model</strong> I will present is a multivariate model, that uses as inputs not only past bitcoin price data, but also other data, like S&amp;P500 price and others. We will then compare the <strong>results </strong>and see which model performs better.</p>
                                        <h2 id="recurrent-neural-networks"><b>Recurrent Neural Networks</b></h2>
                                        <p class="lead">As it is nicely explained in <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">this post</a>:</p>
                                        <p class="citation"><i>“Humans don’t start their thinking from scratch every second. As you read this essay, you understand each word based on your understanding of previous words. You don’t throw everything away and start thinking from scratch again. Your thoughts have persistence.
Traditional neural networks can’t do this, and it seems like a major shortcoming. For example, imagine you want to classify what kind of event is happening at every point in a movie. It’s unclear how a traditional neural network could use its reasoning about previous events in the film to inform later ones.
Recurrent neural networks address this issue. They are networks with loops in them, allowing information to persist.”</i></p>
                                        <p class="lead">That's the reason why RNN, and in particular <strong>LSTM</strong>, are used in <strong>time series analysis</strong>. I will leave a couple of interesting posts in the references that explain briefly LSTM functioning for you to get a better understanding of the following work.</p>
                                        <h2 id="first-model-univariate"><b>First model: univariate</h2>
                                        <h3 id="data-used"><b>Data used</b></h3>
                                        <p class="lead">We downloaded BTC-USD price data from Yahoo Finance, using yfinance python module, from 2014–01–01 to 2020–05–13. We selected the “Close price” column for our analysis, normalizing it using Scikit-Learn’s MinMaxScaler with numbers between zero and one. We then considered the fact that we wanted to predict 1 day ahead (look_back=1), having as input the 60 past observed days, and we finally split the data in train/validate and test sets.</p>
                                        <h3 id="the-model"><b>The model</b></h3>
                                        <p class="lead">The model built is a fairly simple one, being composed of just 5 layers:</p>
                                        <ol>
                                        <li><p>LSTM layer</p>
                                        </li>
                                        <li><p>Dropout layer</p>
                                        </li>
                                        <li><p>LSTM layer</p>
                                        </li>
                                        <li><p>Dropout layer</p>
                                        </li>
                                        <li><p>Dense output layer</p>
                                        </li>
                                        </ol>
                                        <p class="lead">In order to choose the best hyperparameters for our model, we used<strong> <a href="https://github.com/keras-team/keras-tuner">keras-tuner</a></strong>, a python library that let us choose the best performing parameters for our model using a random search. More about that <a href="https://github.com/keras-team/keras-tuner">here</a>.</p>
                                        <p class="lead">After 100 different hyperparameters combinations, we got the following <strong>best model</strong>:</p>
                                        
                                        <script src="https://gist.github.com/federicodeservi/76736d0f490368dc3b2633b93a445a2d.js"></script>

                                        <h3 id="results"><b>Results</b></h3>
                                        <p>The result obtained on the <strong>test set</strong> (new data that the model has never seen before) is the following:</p>
                                        <p><img src="../images/project images/bitcoin/btc1.png" alt=""></p>
                                        <p>As we can see, it performed quite well for our own purposes, even though it only used past data to make new predictions. There is room for improvement, however and thatÔÇÖs why we thought of a second model for our goal.</p>
                                        <h2 id="second-model-multivariate"><b>Second model: multivariate</h2>
                                        <p>We then thought of a second model, that used not only past bitcoin price data, but also other assets that might influence the BTC price, like:</p>
                                        <ol>
                                        <li><p>S&amp;P500 price data</p>
                                        </li>
                                        <li><p>DXY price data</p>
                                        </li>
                                        <li><p>Gold price data</p>
                                        </li>
                                        </ol>
                                        <h3 id="data-used"><b>Data used</b></h3>
                                        <p>We downloaded all of our data from Yahoo Finance, as done before, from 2017–01–01 to 2020–05–13. That is because Bitcoin is still a new asset, and as such, has matured only in recent years, being more and more adopted worldwide. We then saw that the 3 newly added time series (SP500, DXY GOLD) had some <strong>missing values</strong> (especially on Sundays, as we expected) so we chose to fill those empty values with the nearest value available in the time serie. We then normalized it as done previously and fed it to our model.</p>
                                        <h3 id="the-model"><b>The model</b></h3>
                                        <p>The model built is still composed of 5 layers. As done before, we used keras-tuner to get the best possible hyperparameter combination out of 60 different random ones. After that, we got the following <strong>best model</strong>:</p>
                                        
                                        <script src="https://gist.github.com/federicodeservi/38bc662ff413c861ba154316d0093769.js"></script>

                                        <h3 id="results"><b>Results</b></h3>
                                        <p>The result obtained on the <strong>test set</strong> is the following:</p>
                                        <p><img src="../images/project images/bitcoin/btc2.png" alt=""></p>
                                        <h2 id="conclusion"><b>Conclusion</b></h2>
                                        <p>Both models performed quite well for our own research purposes, with little differences between the two, in favor of the <strong>multivariate </strong>model which seemed to produce more accurate predictions.</p>
                                        <p>Even if we came up with quite <strong>good results</strong>, it is definitely <strong>not </strong>possible to predict bitcoin price behavior by using only historical data. In fact, a small difference in the chart above may result in hundreds of dollars of difference, and as such, it is <strong>not usable</strong> in real-life situations.</p>
                                        <h2 id="references"><b>References</b></h2> 
                                        <p class="lead">[0]<a href="https://medium.com/neuronio/predicting-stock-prices-with-lstm-349f5a0974d4">Predicting stock prices with lstm</a>, Alexandre Xavier, (2019) <br>
                                            [1]<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/">Multivariate Time Series Forecasting with LSTMs in Keras</a>, Jason Brownlee, (2017) <br>
                                        [2]<a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a>, Christopher Olah, (2015) <br></p>                                       
                                        
                                        
                                        
                                        

                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
            
            <footer class="text-center space--sm footer-5">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12">
                            
                            <div>
                                <ul class="social-list list-inline list--hover">
                                    <li><a href="#"><i class="socicon socicon-linkedin icon icon--xs"></i></a></li>
                                    <li><a href="#"><i class="socicon socicon-medium icon icon--xs"></i></a></li>
                                    <li><a href="#"><i class="socicon socicon-github icon icon--xs"></i></a></li>
                                    <li><a href="#"><i class="socicon socicon-mail icon icon--xs"></i></a></li>
                                </ul>
                            </div>
                            <div> <a class="type--fine-print" href="../privacy-cookie-policy.html">Privacy Policy</a>  </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
        <script src="../js/jquery-3.1.1.min.js"></script>
        <script src="../js/parallax.js"></script>
        <script src="../js/smooth-scroll.min.js"></script>
        <script src="../js/scripts.js"></script>
        <!-- Global site tag (gtag.js) - Google Analytics - Not active by default as GDPR requires -->
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.js" data-cfasync="false"></script>
        <script>
            window.addEventListener('load', function(){
            window.cookieconsent.initialise({
            revokeBtn: "<div class='cc-revoke'></div>",
            type: "opt-in",
            position: "bottom-left",
            theme: "classic",
            palette: {
                popup: {
                    background: "#252525",
                    text: "#fff"
                    },
                button: {
                    background: "#ff6100",
                    text: "#fff"
                    }
                },
            content: {
                link: "Сookie policy",
                href: "../privacy-cookie-policy.html"
                },
                onInitialise: function(status) {
                if(status == cookieconsent.status.allow) myScripts();
                },
                onStatusChange: function(status) {
                if (this.hasConsented()) myScripts();
                }
            })
            });

            function myScripts() {


            // Google Analytics
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
                ga('create', 'UA-171285482-1', 'auto');
                ga('set', 'allowAdFeatures', false);
                ga('set', 'anonymizeIp', true);
                ga('send', 'pageview');

                
                
                    

            }
        </script>

    </body>

</html>